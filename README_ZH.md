# BBC News è‡ªç„¶èªè¨€æŸ¥è©¢ API

ä¸€å€‹è¼•é‡ç´šè‡ªç„¶èªè¨€æ–°èæŸ¥è©¢å·¥å…·ï¼Œçµåˆ BBC æ–°èèªæ–™åº«èˆ‡ AI æ¨¡å‹ï¼ˆGoogle Gemini æˆ– OpenAI ChatGPTï¼‰å¯¦ç¾å°æ–°èæ–‡ç« çš„èªç¾©åŒ–æœç´¢ã€‚

## ä¸»è¦ç‰¹é»

- ğŸ“° ä½¿ç”¨ SQLite è³‡æ–™åº«å­˜å– BBC News æ–‡ç« æ•¸æ“š
- ğŸ” é«˜æ•ˆçš„æŸ¥è©¢ç·©å­˜æ©Ÿåˆ¶ï¼Œæå‡æŸ¥è©¢é€Ÿåº¦
- ğŸ’¬ æ”¯æŒè‡ªç„¶èªè¨€æŸ¥è©¢è™•ç†ï¼ˆä½¿ç”¨Gemini AIæ¨¡å‹ï¼‰
- ğŸ—„ï¸ ç°¡æ½”ã€æ¨¡å¡ŠåŒ–çš„ä»£ç¢¼çµæ§‹
- ğŸš€ è¼•é‡ç´šè¨­è¨ˆï¼Œæ˜“æ–¼æ“´å±•
- ğŸŒ æä¾›ç¶²é ç•Œé¢é€²è¡Œç›´è§€æŸ¥è©¢

## è³‡æ–™é›†è³‡è¨Š

æœ¬é …ç›®ä½¿ç”¨ BBC News Datasetï¼ŒåŒ…å«äº”å€‹ä¸»è¦é¡åˆ¥çš„æ–°èæ–‡ç« ï¼š
- **business**: å•†æ¥­æ–°è
- **entertainment**: å¨›æ¨‚æ–°è
- **politics**: æ”¿æ²»æ–°è
- **sport**: é«”è‚²æ–°è
- **tech**: ç§‘æŠ€æ–°è

æ•¸æ“šä¾†æºï¼š`https://huggingface.co/datasets/hf-internal/bbc-text/resolve/main/bbc-text.csv`

## ğŸ” å¿«é€Ÿæ¼”ç¤º â€“ åƒ…é—œéµå­—ç‰ˆæœ¬ï¼ˆLangChain ä¹‹å‰çš„åŸºæº–ï¼‰

ç•¶å‰å¯¦ç¾å±•ç¤ºäº†åœ¨**ä¸ä½¿ç”¨**å¤šæ­¥é©Ÿæª¢ç´¢æˆ–ä»£ç†çš„æƒ…æ³ä¸‹ï¼Œæˆ‘å€‘èƒ½é”åˆ°çš„æ•ˆæœã€‚  
å®ƒåªåšä¸€ä»¶äº‹ï¼š

1. **LLM å¾ç”¨æˆ¶çš„è‡ªç„¶èªè¨€æŸ¥è©¢ä¸­æå–ä¸€å€‹é—œéµå­—**  
2. ä½¿ç”¨ **SQL `LIKE`** åœ¨ BBC æ–°èèªæ–™åº«ä¸­æœç´¢è©²é—œéµå­—  
3. è¿”å›å‰ 10 å€‹åŒ¹é…é …ï¼Œé¡¯ç¤ºæ¯ç¯‡æ–‡ç« çš„*é¡åˆ¥*æ¨™ç±¤å’Œå…¶å…§å®¹çš„å‰å¹¾å€‹å­—ç¬¦

### å¦‚ä½•é‹è¡Œ

```bash
# ä¸€æ¬¡æ€§ï¼šå°‡ CSV è½‰æ›ç‚º SQLiteï¼ˆå¦‚å·²å®Œæˆå‰‡è·³éï¼‰
python scripts/csv_to_sqlite.py

# å•Ÿå‹•æœå‹™å™¨
python app.py
```

æ‰“é–‹ http://localhost:5000ï¼Œè¼¸å…¥æŸ¥è©¢ï¼Œé»æ“Šç™¼é€ã€‚

#### æŸ¥è©¢ç¯„ä¾‹

| è¼¸å…¥ | LLM æå–çš„é—œéµå­— |
|-------|----------------------|
| é¡¯ç¤ºé—œæ–¼è¶³çƒçš„é«”è‚²æ–‡ç«  | football |
| é—œæ–¼è˜‹æœçš„ç§‘æŠ€æ–°è | apple |
| é—œæ–¼é£Ÿç‰©çš„æ–‡ç«  | food (è¤‡æ•¸â†’å–®æ•¸) |
| æœ€æ–°æ–°è | (ç„¡é—œéµå­—) â†’ é¡¯ç¤ºæœ€æ–°çš„ 10 ç¯‡æ–‡ç«  |

ç•¶æ²’æœ‰æ–‡ç« åŒ…å«é—œéµå­—æ™‚ï¼Œæ‚¨æœƒçœ‹åˆ°ï¼š
âš ï¸ æœªæ‰¾åˆ°æ–°èã€‚

## å°ˆæ¡ˆçµæ§‹

```
bbc-news-api/
â”œâ”€â”€ app.py              # Flask æ‡‰ç”¨ç¨‹å¼å…¥å£é»
â”œâ”€â”€ db.py               # è³‡æ–™åº«é€£æ¥èˆ‡æŸ¥è©¢è™•ç†
â”œâ”€â”€ gemini_model.py     # Google Gemini API æ•´åˆ
â”œâ”€â”€ chatgpt_model.py    # OpenAI ChatGPT æ•´åˆ
â”œâ”€â”€ requirements.txt    # å°ˆæ¡ˆä¾è³´é …
â”œâ”€â”€ .env                # ç’°å¢ƒè®Šæ•¸ï¼ˆAPI é‡‘é‘°ï¼‰
â”œâ”€â”€ template.env        # ç’°å¢ƒè®Šæ•¸ç¯„æœ¬
â”œâ”€â”€ README.md           # è‹±æ–‡æ–‡æª”
â”œâ”€â”€ README_ZH.md        # ä¸­æ–‡æ–‡æª”
â”‚
â”œâ”€â”€ scripts/            
â”‚   â””â”€â”€ csv_to_sqlite.py  # å°‡ CSV è³‡æ–™é›†è½‰æ›ç‚º SQLite
â”‚
â”œâ”€â”€ static/            
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js      # å‰ç«¯ JavaScript
â”‚
â”œâ”€â”€ templates/         
â”‚   â””â”€â”€ index.html      # ä¸»è¦ç¶²é ç•Œé¢
â”‚
â””â”€â”€ data/              
    â”œâ”€â”€ bbc-news.csv    # åŸå§‹ CSV è³‡æ–™é›†
    â””â”€â”€ bbc_news.sqlite # SQLite è³‡æ–™åº«
```

## ç³»çµ±æ¶æ§‹

```mermaid
graph TD
    A[ä½¿ç”¨è€…] -->|è‡ªç„¶èªè¨€æŸ¥è©¢| B[Flask ç¶²é æ‡‰ç”¨]
    B -->|è™•ç†è«‹æ±‚| C[æŸ¥è©¢è™•ç†å™¨]
    C -->|SQL æŸ¥è©¢| D[SQLite è³‡æ–™åº«]
    D -->|çµæœ| C
    C -->|è§£æè‡ªç„¶èªè¨€æŸ¥è©¢| E{LLM æ¨¡å‹}
    E -->|æå–é¡åˆ¥å’Œé—œéµå­—| C
    E -->|æ ¹æ“šé…ç½®åˆ‡æ›| F[Gemini API]
    E -->|æ ¹æ“šé…ç½®åˆ‡æ›| G[OpenAI API]
    C -->|JSON å›æ‡‰| B
    B -->|é¡¯ç¤ºçµæœ| A
```

## å®‰è£èˆ‡é‹è¡Œ

### å‰ç½®éœ€æ±‚
- Python 3.8+
- Google Gemini æˆ– OpenAI çš„ API é‡‘é‘°ï¼ˆå–æ±ºæ–¼æ‚¨æƒ³ä½¿ç”¨çš„ LLMï¼‰

### å®‰è£æµç¨‹

1. å…‹éš†å„²å­˜åº«ï¼š
   ```bash
   git clone https://github.com/yourusername/bbc-news-api.git
   cd bbc-news-api
   ```

2. å‰µå»ºä¸¦å•Ÿå‹•è™›æ“¬ç’°å¢ƒï¼š
   ```bash
   python -m venv venv
   source venv/bin/activate  # åœ¨ Windows ä¸Šï¼švenv\Scripts\activate
   ```

3. å®‰è£ä¾è³´é …ï¼š
   ```bash
   pip install -r requirements.txt
   ```

4. è¨­ç½®ç’°å¢ƒè®Šæ•¸ï¼š
   ```bash
   cp template.env .env
   # ç·¨è¼¯ .env æª”æ¡ˆä¸¦åŠ å…¥æ‚¨çš„ API é‡‘é‘°
   ```

5. æº–å‚™è³‡æ–™ï¼š
   ```bash
   # ç¢ºä¿ bbc-news.csv ä½æ–¼ data/ è³‡æ–™å¤¾ä¸­
   python scripts/csv_to_sqlite.py
   ```

6. é‹è¡Œæ‡‰ç”¨ç¨‹å¼ï¼š
   ```bash
   python app.py
   ```

æ‡‰ç”¨ç¨‹å¼å°‡åœ¨ http://localhost:5000 ä¸Šå¯ç”¨

## API ç«¯é»

### `/query` (POST)
ä½¿ç”¨é…ç½®çš„ LLM è™•ç†è‡ªç„¶èªè¨€æŸ¥è©¢ã€‚

**è«‹æ±‚ï¼š**
```json
{
  "query": "é¡¯ç¤ºé—œæ–¼è˜‹æœçš„ç§‘æŠ€æ–°è"
}
```

**å›æ‡‰ï¼š**
```json
{
  "query": "é¡¯ç¤ºé—œæ–¼è˜‹æœçš„ç§‘æŠ€æ–°è",
  "parsed": {
    "category": "tech",
    "keyword": "Apple"
  },
  "results": [
    {
      "category": "tech",
      "text": "...[æ–‡ç« å…§å®¹]..."
    },
    ...
  ]
}
```

### `/news` (GET)
ç²å–æ–°èæ–‡ç« ï¼Œå¯é¸æ“‡æ€§éæ¿¾ã€‚

**åƒæ•¸ï¼š**
- `category`ï¼šæŒ‰æ–°èé¡åˆ¥éæ¿¾ï¼ˆbusiness, entertainment, politics, sport, techï¼‰
- `keyword`ï¼šæŒ‰æ–‡æœ¬ä¸­çš„é—œéµå­—éæ¿¾
- `page`ï¼šé ç¢¼ï¼ˆé è¨­ï¼š1ï¼‰
- `limit`ï¼šæ¯é çµæœæ•¸ï¼ˆé è¨­ï¼š20ï¼‰

**å›æ‡‰ï¼š**
```json
{
  "page": 1,
  "limit": 20,
  "total_pages": 10,
  "total": 200,
  "data": [
    {
      "category": "tech",
      "text": "...[æ–‡ç« å…§å®¹]..."
    },
    ...
  ]
}
```

### `/search` (GET)
åœ¨æ–°èè³‡æ–™åº«ä¸­é€²è¡Œç°¡å–®çš„é—œéµå­—æœç´¢ã€‚

**åƒæ•¸ï¼š**
- `q`ï¼šæœç´¢æŸ¥è©¢
- `page`ï¼šé ç¢¼ï¼ˆé è¨­ï¼š1ï¼‰
- `limit`ï¼šæ¯é çµæœæ•¸ï¼ˆé è¨­ï¼š20ï¼‰

**å›æ‡‰ï¼š**
èˆ‡ `/news` ç«¯é»æ ¼å¼ç›¸åŒ

### `/system_status` (GET)
æª¢æŸ¥ç³»çµ±ç‹€æ…‹å’Œè³‡æ–™åº«å¯ç”¨æ€§ã€‚

**å›æ‡‰ï¼š**
```json
{
  "db_exists": true,
  "time": 1618123456.789
}
```

## LLM æ•´åˆ

æ‡‰ç”¨ç¨‹å¼å¯ä»¥é€šéåœ¨ `.env` æ–‡ä»¶ä¸­è¨­ç½® `AI_MODEL_TYPE` ç’°å¢ƒè®Šæ•¸ï¼Œé…ç½®ä½¿ç”¨ Google Gemini æˆ– OpenAI çš„æ¨¡å‹ï¼š

```
AI_MODEL_TYPE=GEMINI  # æˆ– OPENAI
GEMINI_API_KEY=your_api_key_here
```

## æŸ¥è©¢ç¯„ä¾‹

- "å°‹æ‰¾é—œæ–¼æ‰‹æ©Ÿçš„ç§‘æŠ€æ–°è"
- "é¡¯ç¤ºé—œæ–¼è¶³çƒçš„é«”è‚²æ–‡ç« "
- "æœ‰å“ªäº›æåˆ°é›»å½±çš„å¨›æ¨‚æ–°èï¼Ÿ"
- "å°‹æ‰¾ 2021 å¹´çš„å•†æ¥­æ–°è"
- "é¡¯ç¤ºé—œæ–¼é¸èˆ‰çš„æ”¿æ²»æ–°è"

- 
